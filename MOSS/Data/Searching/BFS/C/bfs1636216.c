#define FOR(i,a,b) for (int i=(a);i<(b);i++)
#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)
#define REP(i,n) for (int i=0;i<(n);i++)
#define RREP(i,n) for (int i=(n)-1;i>=0;i--)

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>


int NL_num[100];
int NL[100][100];
int found[100];
int distance[100];



#define MAX_LENGTH  (100)

typedef struct{
    int array[MAX_LENGTH];
    int first;
    int last;
}QUEUE;

QUEUE pq;

void init(QUEUE*);
int enqueu(QUEUE*,int);
int dequeue(QUEUE*,int*);


void init(QUEUE* pQueue)
{
    int i;
    for(i = 0; i < MAX_LENGTH; i++){
        pQueue->array[i] = 0;
    }
    pQueue->first = 0;
    pQueue->last = 0;
}

int enqueue(QUEUE* pQueue,int value)
{
    if((pQueue->last + 1) % MAX_LENGTH == pQueue->first){
        return 0;
    }
    pQueue->array[pQueue->last] = value;
    pQueue->last = (pQueue->last + 1) % MAX_LENGTH;
    return 1;
}


int dequeue(QUEUE* pQueue,int* pValue)
{
    if(pQueue->first == pQueue->last)
    {
        return 0;
    }
    *pValue = pQueue->array[pQueue->first];
    pQueue->first = (pQueue->first+1) % MAX_LENGTH;
    return 1;
    
}

/*
 * NL:??£??\????????????????????????
 * NL_num:??£??\?????????NL???????????????????´??????????????´???°
 * ans:???????´???°?????°????????????????????????????´??????????????????????
 * ans_num:2?????\???
 * found:???????´???°?????????????????§???????????????????????????????????????????????°
 * ?¬??????¢?????????????´??????????
 */
void bfs(int n){
    
    int i, num,index, flag;
    index = n-1;
    
    //???????????????????????´????????????found????????°????????????
    if (!found[index]) {
        found[index] = 1;
    }
    
    enqueue(&pq, index);
    flag = dequeue(&pq, &index);
    
    
    while (flag) {
        num = NL_num[index];
        for (i=0; i < num; i++) {
            
            if ( !found[ NL[index][i] - 1 ] ) {
                enqueue(&pq, NL[index][i] - 1);
                distance[NL[index][i] - 1] = distance[index] + 1;
                found[ NL[index][i] - 1 ]  = 1;
            }
        }
        flag = dequeue(&pq, &index);
    }
    
    return;
    
}

int main(){
    
    int i,j,n, cn, v, u;
    
    //the number
    scanf("%d",&n);
    u = 0;
    
    for (i=0; i < n; i++) {
        scanf("%d %d",&u, &cn);
        NL_num[u-1] = cn;
        for (j=0; j < cn; j++) {
            scanf("%d",&v);
            NL[u-1][j] = v;
        }
    }
    
    for (i=0; i < n; i++) {
        distance[i] = -1;
    }
    
    distance[0] = 0;
    
    bfs(1);
    
    for (i=0; i<n; i++) {
        printf("%d %d\n", i+1, distance[i]);
    }
    
    return 0;
}
